<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>EtherPlant</title>
	<link rel="stylesheet" href="//code.jquery.com/ui/1.11.2/themes/smoothness/jquery-ui.css">
	<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.min.js"></script>
	<!--  taken from https://github.com/johan/js-deflate -->
	<script src="rawdeflate.js"></script>

	<link rel="stylesheet" href="estilo.css">
	<script src="etherplant.js"></script>
</head>
<body>
	<div id="pad" class="moveable working">
		<div id="pad-inner">
				<iframe id='pad-iframe' name='embed_readwrite' src='' width=100% height=100%></iframe>
		</div>
	</div>

	<!--
	<img id="im" src=http://www.plantuml.com/plantuml/img/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000>
	-->
	<div id="viewer" class="moveable working">
		<div id="sv"></div>
	</div>
	<div class="working">
		<p class="infos">
			Export:
			<a id="png-link" href="">PNG</a>
			<a id="svg-link" href="">SVG</a>
			<a id="svg-dinamic" href="">Always-Latest-SVG</a>
		</p>
		<p class="infos">
			(The visualization is updated every 5s)
		</p>
	</div>
	<div class="not-working">
		<h1>EtherPlant</h1>
		<h2>How to use?</h2>
		<p>To use, place a URL to an EtherPad in the params of this page. Example: "?https://pad.okfn.org/p/etherplant".</p>
		<p>A full working URL would be something like <a href="//andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/etherplant">andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/etherplant</a></p>
		<p>You can change the last word in the link to have a new pad. For example:</p>
		<ul>
			<li>
				<a href="//andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/mypersonalplantuml">andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/mypersonalplantuml</a>
			</li>
			<li>
				<a href="//andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/9127498721498">andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/9127498721498</a>
			</li>
			<li>
				<a href="//andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/testestest">andresmrm.github.io/EtherPlant/src/etherplant.html?https://pad.okfn.org/p/testestest</a>
			</li>
		</ul>
		<p>And you can share your EtherPlant with others sharing the full link.</p>
		<h2>Bookmarklet</h2>
		<p>And this is a test bookmarklet (drag it to your bookmarks, and use it when in a Pad [it's seems to work only in HTTP Pads, because of Cross-site request forgery policies]):</p>
		<a href='javascript:(function(e,a,g,h,f,c,b,d){if(!(f=e.jQuery)||g>f.fn.jquery||h(f)){c=a.createElement("script");c.type="text/javascript";c.src="http://ajax.googleapis.com/ajax/libs/jquery/"+g+"/jquery.min.js";c.onload=c.onreadystatechange=function(){if(!b&&(!(d=this.readyState)||d=="loaded"||d=="complete")){h((f=e.jQuery).noConflict(1),b=1);f(c).remove()}};a.documentElement.childNodes[0].appendChild(c)}})(window,document,"1.3.2",function($,L){$.getScript("https://github.com/andresmrm/EtherPlant/raw/master/src/etherplant_bookmarklet.js");});'>EtherPlant</a>
		<p>One example of an HTTP pad? <a href="http://piratepad.be">http://piratepad.be</a></p>
		<h2>Known Issues</h2>
		<h3>"This is a bad implementation and you should feel bad."</h3>
		<p><a href="https://github.com/andresmrm/EtherPlant/issues/1">As stated by JohnMcLear</a>, <a href="https://github.com/ether/etherpad-lite/graphs/contributors">one of the main developers of EtherPad-Lite</a>, this code is a bad implementation. Why? It requests the TXT exportation of the current pad every 5s. That's ugly, but the other option is to implement it server-side (this implementation is totally client-side), and host a modified EtherPad that supports integration with PlantServer. That's out of the scope of this project, and has the disadvantage of not allowing you to visualize a pad in any EtherPad server.</p>
		<p>The bookmarklet somehow solves this problem. It gets the text directly from the iFrame, and not from the EtherPad server. AFAK this can only be done via bookmarklet, because of CSRF...</p>
		<p>(Anyway, the current EtherPlant code is actually quite messed up... Feel free to submit patches, or rewrite it. =] )
		<p>(JohnMcLear seems to have implemented a <a href="https://github.com/JohnMcLear/ep_plantuml">plug-in for the server-side solution</a>.)
		<h3>HTTPS Everywhere</h3>
		<p>HTTPS Everywhere enforces HTTPS on GitHub, and so, on this page, hosted on GitHub. The current PlantServer allows only HTTP. So you'll have half of the page in HTTPS and half in HTTP, what won't work. To solve this you can try to: use the Bookmarklet in a HTTP Pad or host this code in a HTTP website.</p>
		<h3>Others</h3>
		<p>The EtherPad used must support "/export/txt" to export the content has text. At least for now...</p>
	</div>

	<div id="footer">
		<a href="//andresmrm.github.io/EtherPlant/src/etherplant.html">Help</a>
		<a href="https://github.com/andresmrm/EtherPlant">Source</a>
		Powered by:
		<a href="http://www.plantuml.com">PlantUML</a>
		<a href="http://etherpad.org">EtherPad</a>
	</div>
</body>
</html>
